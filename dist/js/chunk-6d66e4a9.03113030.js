(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6d66e4a9"],{"99af":function(t,a,s){"use strict";var i=s("23e7"),e=s("d039"),o=s("e8b5"),r=s("861d"),n=s("7b0b"),c=s("50c4"),l=s("8418"),d=s("65f0"),u=s("1dde"),f=s("b622"),h=s("2d00"),v=f("isConcatSpreadable"),p=9007199254740991,g="Maximum allowed index exceeded",m=h>=51||!e((function(){var t=[];return t[v]=!1,t.concat()[0]!==t})),b=u("concat"),C=function(t){if(!r(t))return!1;var a=t[v];return void 0!==a?!!a:o(t)},_=!m||!b;i({target:"Array",proto:!0,forced:_},{concat:function(t){var a,s,i,e,o,r=n(this),u=d(r,0),f=0;for(a=-1,i=arguments.length;a<i;a++)if(o=-1===a?r:arguments[a],C(o)){if(e=c(o.length),f+e>p)throw TypeError(g);for(s=0;s<e;s++,f++)s in o&&l(u,f,o[s])}else{if(f>=p)throw TypeError(g);l(u,f++,o)}return u.length=f,u}})},b6d4:function(t,a,s){"use strict";s.r(a);var i=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"cart favorite"},[s("div",{staticClass:"container"},[s("h1",{staticClass:"d-inline-block"},[t._v("我的最愛")]),s("hr"),t.favoriteProd.length>0?s("div",{staticClass:"cart-area"},[s("div",{staticClass:"clearfix"}),s("div",{staticClass:"table-responsive"},[s("table",{staticClass:"table"},[t._m(0),s("tbody",[t._l(t.favoriteProd,(function(a){return s("tr",{key:a.id},[s("td",{staticClass:"name"},[s("a",{attrs:{href:"#"}},[t._v(t._s(a.title))])]),s("td",{staticClass:"img"},[s("img",{attrs:{src:a.imageUrl[0],alt:""}})]),s("td",{staticClass:"unit"},[t._v(t._s(a.unit))]),s("td",{staticClass:"prod-price"},[t._v(" "+t._s(t._f("currency")(a.price))+" ")]),s("td",{staticClass:"add-to-cart"},[s("button",{staticClass:"btn",on:{click:function(s){return t.addToCart(a.id)}}},[s("i",{staticClass:"fa fa-cart-plus"})])]),s("td",{staticClass:"trash"},[s("button",{staticClass:"btn",on:{click:function(s){return t.rmFavorited(a.id)}}},[s("i",{staticClass:"fa fa-times"})])])])})),s("tr",[t._m(1),s("td",{staticClass:"text-center"},[t._v(" "+t._s(t.favoriteTotalNum)+" ")])])],2),s("tfoot",[s("tr",[t._m(2),s("td",{staticClass:"text-center prod-price"},[t._v(" "+t._s(t._f("currency")(t.favoriteTotal))+" ")])])])])]),s("div",{staticClass:"float-right"},[s("button",{staticClass:"btn first",attrs:{type:"button"},on:{click:t.rmAllFavorites}},[s("i",{staticClass:"fa fa-times"}),t._v(" 全部移除 ")])])]):s("div",{staticClass:"cont-shop text-center"},[s("br"),s("p",[t._v("目前尚無我的最愛")]),s("br"),s("router-link",{staticClass:"btn",attrs:{to:"/works"}},[t._v("繼續挑選")])],1)])])},e=[function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("thead",[s("tr",[s("th",[t._v("品名")]),s("th",[t._v("圖片")]),s("th",[t._v("單位")]),s("th",[t._v("單價")]),s("th",[t._v("購買")]),s("th",[t._v("移除")])])])},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("td",{staticClass:"text-right",attrs:{colspan:"5"}},[s("span",{staticClass:"total-word"},[t._v("總數")])])},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("td",{staticClass:"text-right",attrs:{colspan:"5"}},[s("span",{staticClass:"total-word"},[t._v("總計")])])}],o=(s("99af"),s("4de4"),s("4160"),s("c975"),s("a434"),s("159b"),{data:function(){return{status:{loadingNum:""},carts:[],favoriteTotal:0,favoriteTotalNum:0,cartPageTotalNum:0,favoriteProd:[],favorited:JSON.parse(localStorage.getItem("favoriteList"))||[],prods:[]}},methods:{getProds:function(){var t=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.isLoading=!0;var s="".concat("https://course-ec-api.hexschool.io","/api/").concat("bba8c8a3-a5f2-4a81-91ef-9273532ebb26","/ec/products?page=").concat(a,"&paged=40");this.$http.get(s).then((function(a){t.isLoading=!1,t.prods=a.data.data,console.log("prods",t.prods),t.pagination=a.data.meta.pagination,t.getFavorite()})).catch((function(a){console.dir(a),t.isLoading=!1,t.$bus.$emit("message:push",a.response.data.message,"danger")}))},getFavorite:function(){var t=this;console.log(this.favorited),console.log(this.prods),this.favoriteTotalNum=this.favorited.length,this.favoriteProd=this.prods.filter((function(a){return t.favorited.indexOf(a.id)>-1})),console.log(this.favoriteProd),this.updateFavoriteTotal(),this.$bus.$emit("get-favorite-num")},updateFavoriteTotal:function(){var t=this;this.favoriteTotal=0,this.favoriteProd.forEach((function(a){t.favoriteTotal+=a.price}))},rmFavorited:function(t){var a=this.favorited.indexOf(t);-1!==a&&this.favorited.splice(a,1),localStorage.setItem("favoriteList",JSON.stringify(this.favorited)),this.getProds(),this.$bus.$emit("message:push","已移出我的最愛","info")},rmAllFavorites:function(){this.favorited=[],localStorage.setItem("favoriteList",JSON.stringify(this.favorited)),this.getProds(),this.$bus.$emit("message:push","已全數移出","info")},updateQuantity:function(t,a){var s=this;if(!(a<=0)){this.status.loadingNum=t,console.log(this.status.loadingNum);var i="".concat("https://course-ec-api.hexschool.io","/api/").concat("bba8c8a3-a5f2-4a81-91ef-9273532ebb26","/ec/shopping"),e={product:t,quantity:a};console.log("updateCart",e),console.log(e.quantity),this.$http.patch(i,e).then((function(t){s.status.loadingNum="",console.log(t),console.log(s.carts.length),s.favoriteTotalNum=0,s.cartPageTotalNum=0,s.$bus.$emit("get-cart-num"),s.updateFavoriteTotal(),s.getCart()})).catch((function(t){console.dir(t)}))}},getCart:function(){var t=this,a="".concat("https://course-ec-api.hexschool.io","/api/").concat("bba8c8a3-a5f2-4a81-91ef-9273532ebb26","/ec/shopping");this.$http.get(a).then((function(a){console.log("getCart",a),t.carts=a.data.data,t.cartTotalNum=0,t.carts.forEach((function(a){t.cartPageTotalNum+=a.quantity})),t.cartTotal=0,t.updateCartTotal()})).catch((function(t){console.dir(t)}))},addToCart:function(t){var a=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.isLoading=!0;var i="".concat("https://course-ec-api.hexschool.io","/api/").concat("bba8c8a3-a5f2-4a81-91ef-9273532ebb26","/ec/shopping"),e={product:t,quantity:s};console.log(e),this.$http.post(i,e).then((function(t){a.isLoading=!1,console.log(t),a.$bus.$emit("message:push",t.data.data.product.title+"已加入購物車","info"),a.$bus.$emit("get-cart-num")})).catch((function(t){a.isLoading=!1,console.dir(t.response.data.errors[0]),a.$bus.$emit("message:push",t.response.data.errors[0],"danger")}))}},created:function(){this.getProds(),this.getCart()}}),r=o,n=s("2877"),c=Object(n["a"])(r,i,e,!1,null,null,null);a["default"]=c.exports},c975:function(t,a,s){"use strict";var i=s("23e7"),e=s("4d64").indexOf,o=s("a640"),r=s("ae40"),n=[].indexOf,c=!!n&&1/[1].indexOf(1,-0)<0,l=o("indexOf"),d=r("indexOf",{ACCESSORS:!0,1:0});i({target:"Array",proto:!0,forced:c||!l||!d},{indexOf:function(t){return c?n.apply(this,arguments)||0:e(this,t,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=chunk-6d66e4a9.03113030.js.map